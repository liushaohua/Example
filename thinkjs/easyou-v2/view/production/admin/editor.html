<link rel="stylesheet" href="/static/editor/css/editor.css"><link rel="stylesheet" href="/static/highlightJS/styles/github.css"><script src="/static/editor/js/editor.js"></script><script src="/static/plupload/plupload.full.min.js"></script><script src="/static/highlightJS/highlight.pack.js"></script><div id="uploadContainer" style="display:none"><input type="button" value="选择文件" class="button border-black button-little" id="btnBrowse"> <input type="button" value="上传文件" class="button border-black button-little" id="btnUpload"><ul id="fileList"></ul></div><script>$(function(){$("pre code").each(function(n,i){hljs.highlightBlock(i)});var n,i=$("#uploadContainer"),e=$("#fileList"),t=$("#btnUpload"),o=$("#content").wangEditor({uploadImgComponent:i}),l=new plupload.Uploader({browse_button:"btnBrowse",url:"/admin/upload",flash_swf_url:"/static/plupload/Moxie.swf",sliverlight_xap_url:"/static/plupload/Moxie.xap",filters:{mime_types:[{title:"图片文件",extensions:"jpg,gif,png,bmp"}]}}),p=[];l.init(),l.bind("FilesAdded",function(n,i){$.each(i,function(n,i){var t=i.name,o='<li id="file-'+i.id+'"> <p class="file-name">'+t+'</p> <p class="progress"></p></li>';e.append(o)})}),l.bind("UploadProgress",function(n,i){e.find(".progress").text(i.percent+"%")}),l.bind("FileUploaded",function(n,i,e){var t=e.response;"0"==t?alert("上传失败"):p.push(t)}),l.bind("UploadComplete",function(i,t){$.each(p,function(i,e){o.command(n,"insertHTML",'<img src="'+e+'"/>')}),p=[],e.html("")}),t.click(function(i){n=i,l.start()})});</script>